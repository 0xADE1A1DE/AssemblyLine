.TH ASMLINE 1 2021-12-31 GNU

.SH NAME
asmline \- assemblyline tool 

.SH SYNOPSIS
.B asmline
[\fB\-r\fR]
[\fB\-p\fR]
[\fB\-c\fR \fICHUNK_SIZE>1\fR]
[\fB\-o\fR \fIFILENAME\fR]
[\fB\-n\fR]
[\fB\-s\fR]
[\fB\-m\fR]
[\fB\-h\fR]
[\fB\-v\fR]
path/to/file.asm

.SH DESCRIPTION
.B asmline 
Generates machine code from a file or stdin containing x64 assembly instructions. 

.br
Machine code could be executed directly without the need for an executable file format. 
.br
Obtain command-line instructions for generating an ELF binary file from assembly code.

.SH OPTIONS
.TP

.BR \-r ", " \-\-return
Executes assembly code and prints out the contents of the rax register (return register).
.TP

.BR \-p ", " \-\-print
The corresponding machine code will be printed to stdout in hex form.
.br
Output is similar to `objdump`: Byte-wise delimited by space and linebreaks after 7 bytes.
.br
If -c is given, the chunks are delimited by '|' with each chunk on one line.

.TP
.BR \-P ", " \-\-printfile " " \fIFILENAME
The corresponding machine code will be printed to \fIFILENAME\fR in binary form.
.br
Can be set to '/dev/stdout' to write to stdout.

.TP
.BR \-c ", " \-\-chunk " " \fICHUNK_SIZE>1
Sets a given \fICHUNK_SIZE\fR boundary in bytes. Nop padding will be used to ensure 
.br
no instruction opcode will cross the specified \fICHUNK_SIZE\fR boundary.

.TP
.BR \-o ", " \-\-object " " \fIFILENAME
Generates a binary file from path/to/file.asm called \fIFILENAME\fR.bin in the current directory.

.TP
.BR \-n ", " \-\-nasm
Enables nasm-style mov-immediate register-size optimization.
.br
ex: if immediate size for mov is less than or equal to max signed 32 bit assemblyline 
.br
    will emit code to mov to 32-bit register rather than 64-bit.
.br
That is: "mov rax, 0x7fffffff" as "mov eax, 0x7fffffff" -> b8 ff ff ff 7f
.br
note: rax got optimized to eax for faster immediate to register transfer and
.br
      produces a shorter instruction.
.TP
.BR \-t ", " \-\-strict
Disables nasm-style mov-immediate register-size optimization.
.br
ex: even if immediate size for mov is less than or equal to max signed 32 bit assemblyline 
.br
    will pad the immediate to fit 64bit.
.br
That is: "mov rax,0x7fffffff" as "mov rax,0x000000007fffffff" 
.br
          -> 48 b8 ff ff ff 7f 00 00 00 00

.TP
.BR \-s ", " \-\-smart
Assemblyline will check the immediate value for leading 0's and thus allows manual
.br 
optimizations. Immediate must be zero padded to 64-bits exactly to ensure it will not optimize.
.br
This is currently set as default.
.br
ex: "mov rax, 0x000000007fffffff" ->  48 b8 ff ff ff 7f 00 00 00 00
.br
    "mov rax, 0x7fffffff" -> b8 ff ff ff 7f

.TP
.BR \-h ", " \-\-help
Prints usage information to stdout and exits.
.TP
.BR \-v ", " \-\-version
Prints version information to stdout and exits.

.SH SEE ALSO
.B libassemblyline(3)